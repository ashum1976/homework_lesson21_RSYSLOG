# Provides UDP syslog reception. SELinux dont manage port 35514 on client, and allow connect on client. По UDP протоколу SELinux на клиенте не управляет соединениями, и разрешает их, в отличии от TCP
#Для большей секьюрности будем использовать TCP протокол, хотя он медленне и для данных целей больше UDP подходит.
#module(load="imudp")
#input(type="imudp" port="35514")

# Provides TCP syslog reception
# for parameters see http://www.rsyslog.com/doc/imtcp.html
module(load="imtcp")
input(type="imtcp" port="35514")

#Templates

template (name="path_progname_save" type="string" string="/var/log/remote/%hostname%/%hostname%-%programname%.log")
template (name="path_ip_save" type="string" string="/var/log/remote/%HOSTNAME%/%fromhost-ip%-%programname%.log")
